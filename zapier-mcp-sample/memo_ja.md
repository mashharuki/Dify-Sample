# Dify MCP プラグイン実践ガイド：Zapier を AI エージェントのツール呼び出しに簡単に統合する方法

Model Context Protocol（MCP）を使って、何千もの Zapier アプリを Dify AI エージェントに統合しましょう。
Leilei
プロダクトマーケティング
投稿日：2025 年 4 月 1 日
製品・2025 年 4 月 1 日

## Dify MCP プラグイン実践ガイド：Zapier を AI エージェントのツール呼び出しに簡単に統合する方法

2025 年は「AI エージェントの年」と言われています。AI エージェントが急速に進化する中、大規模言語モデル（LLM）が実世界のデータやツールとシームレスに連携できるようにすることが重要課題となっています。そこで登場したのが、2024 年後半に Anthropic によって導入された Model Context Protocol（MCP）です。これは急速に広く認知される標準となっています。
MCP は AI 世界の USB-C ポートのようなものと考えてください。明確なガイドラインを定義し、AI モデルが様々な外部ツールや API を発見、理解し、安全に呼び出せるようにします。この画期的な技術により：

開発者は各外部サービスに対して複雑なカスタム統合を行う必要がなくなりました
ユーザーは何千もの第三者アプリケーションを簡単に活用でき、AI との対話を単なる会話から強力なアクションへと変えることができます—日常的なタスク処理からデータ分析、マーケティング自動化まで

Dify コミュニティで提供される MCP プラグイン
Dify コミュニティでは、MCP が大きな注目を集めており、開発者たちは外部 MCP サービス（Zapier や Composio など）をエージェントワークフローに簡単に接続できる強力なプラグインをいくつか提供しています：
MCP SSE
HTTP + Server-Sent Events（SSE）を使用して 1 つ以上の MCP サーバーと通信するプラグインで、エージェントが動的に外部ツールを発見し呼び出すことを可能にします。
MCP Agent Strategy
MCP をワークフローエージェントノードに直接統合し、エージェントが MCP で定義されたロジックに基づいて自律的に外部ツールの決定と呼び出しを行えるようにします。
Zapier MCP を Dify に統合する
Zapier MCP サーバーは 7,000 以上のアプリと 30,000 以上のアクションを単一の MCP サーバー URL にパッケージ化しています。メールから CRM の更新、Slack 通知まで、Zapier でアクションを素早く設定し、それらを Dify エージェントワークフローに直接組み込むことができます。
クイックセットアップ

Zapier MCP 設定にアクセスする
あなた専用の MCP サーバーエンドポイントリンクをコピーする
「Edit MCP Actions」をクリックして新しいツールとアクションを追加する
アプリケーション（例：Gmail）を選択する
「メール送信」などの特定のアクションを選択して設定する

メール送信を設定するには：

Gmail の下にある「Connect」をクリックし、ログインしてアカウントを認証します
受信者、件名、本文などのフィールドには「Have AI guess a value」を選択し、エージェントとのやり取りに基づいた動的な AI 駆動コンテンツ生成を可能にします
追加のアクションでツールキットを拡張するために繰り返します

動的ツール呼び出しのための MCP SSE プラグイン
Dify マーケットプレイスから MCP SSE プラグインをインストールします。インストール後、以下のテンプレートの URL をあなたの Zapier MCP Server URL に置き換え、完全な JSON 設定をプラグインに貼り付けます：
json コピー{
"server_name": {
"url": "https://actions.zapier.com/mcp/*******/sse",
"headers": {},
"timeout": 5,
"sse_read_timeout": 300
}
}
複数の MCP サーバー（例：Composio）の場合、設定は次のようになります：
json コピー{
"server_name1": {
"url": "http://127.0.0.1:8000/sse",
"headers": {},
"timeout": 5,
"sse_read_timeout": 300
},
"server_name2": {
"url": "http://127.0.0.1:8001/sse"
}
}
設定後、新しいエージェントアプリを作成し、「ツール」セクションで MCP SSE プラグインを有効にします。エージェントはユーザーの意図に基づいて関連ツールをインテリジェントに呼び出します—例えば、統合された Gmail アクションを通じて自動的にメールを作成して送信します。
さらに、連絡先の Excel ファイルを Dify のナレッジベースにアップロードできます。これにより、名前とメッセージ内容だけを提供するだけで、エージェントが受信者のメールアドレスを自動的に照合できるようになります。また、以下に示すように、送信前にユーザーによってメールが確認されるよう特定のプロンプトを設定することもできます：
GPT-4o プロンプト例：
コピー# 役割
あなたはメール送信アシスタントです。

# 機能

1. `gmail_send_email`というツールを使用してメールを送信できます。
2. ナレッジベースで連絡先のメールアドレスを自動的に検索できます。

# ワークフロー

1. ユーザー{{user_name}}が送信者です。ユーザーのリクエストに基づいて、受信者、件名、メール本文を決定します。必要に応じて、ナレッジベースで受信者のメールアドレスを検索します。
2. ツールを呼び出してメールを送信する前に、完全なメール内容（受信者、件名、本文）をユーザー{{user_name}}に表示し、確認を求める必要があります。
3. ユーザーの確認を受け取った後、ツールを呼び出してメールを送信する準備をします。

# ツール呼び出し要件（コア指示）

1. メールを送信するには、`gmail_send_email`という名前のツールのみを呼び出す必要があります。
2. `gmail_send_email`ツールを呼び出す際、以下の 3 つのキーのみを含む JSON オブジェクトを構築する必要があります：
   `to`: 値は受信者のメールアドレス（文字列）。
   `subject`: 値はメールの件名（文字列）。
   `body`: 値はメール本文（文字列）。
3. 次に、この完全な JSON オブジェクトを JSON 標準に準拠した文字列にシリアル化し、この文字列を`gmail_send_email`ツールの`arguments`パラメータとして渡します。
   エージェントストラテジープラグインを通じた MCP の統合
   SSE プラグインの他に、MCP Agent Strategy プラグインはワークフローエージェントノードに直接 MCP を埋め込みます。
   インストール後、同様に MCP サーバー URL を設定します：
   json コピー{
   "server_name": {
   "url": "https://actions.zapier.com/mcp/*******/sse",
   "headers": {},
   "timeout": 5,
   "sse_read_timeout": 300
   }
   }
   これを設定すると、ワークフローエージェントは自動化されたワークフローの一部として、Gmail メールの送信などのタスクを実行するために Zapier MCP を自律的に活用できるようになります。
   最後に
   現在、Dify の MCP 機能は優れたコミュニティ開発のプラグインに依存しています。すべての貢献者に心から感謝いたします！一方で、私たちはネイティブの MCP サポートを積極的に開発しており、Zapier や Composio などの外部サービスを Dify 内で直接設定することをさらに容易にし、すべてのユーザーにとってより豊かで強力な統合を作成しています。続報をお待ちください！
